<div class="station-grid">
    {% for station in stations %}
    <div class="station-card">
        <div class="card-top">
            <div class="freq-tag">{{ "%.1f"|format(station.frequency) }} MHz</div>
            <div class="pi-tag" title="PI Code">{{ station.pi if station.pi else '----' }}</div>
        </div>

        <div class="card-main">
            <div class="station-name {{ 'empty' if not station.ps }}">
                {{ station.ps if station.ps else "DETECTOR ACTIVE" }}
            </div>
            <div class="pty-tag">{{ station.pty | pty_name }}</div>
        </div>

        <div class="rt-container">
            <div class="rt-scroll-box">
                {{ station.rt if station.rt else '... monitoring ...' }}
            </div>
        </div>

        <div class="card-footer">
            <div class="flags">
                <span class="flag {{ 'active tmc' if station.tmc }}" title="TMC">M</span>
                <span class="flag {{ 'active ta' if station.ta }}" title="TA">A</span>
                <span class="flag {{ 'active tp' if station.tp }}" title="TP">P</span>
            </div>
            <div class="stats">
                <span class="pkts">PKTS: {{ station.hit_count }}</span>
                <span class="time">{{ station.last_seen.split(' ')[1].split('.')[0] if station.last_seen else ''
                    }}</span>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

{% if not stations %}
<div class="no-data-notice">
    <div class="pulse">SQUELCH ON</div>
    <p>correlation required</p>
</div>
{% endif %}

<style>
    .station-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 15px;
        padding: 15px;
    }

    .station-card {
        background: #11141d;
        border: 1px solid #232738;
        border-radius: 8px;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
        transition: transform 0.1s, border-color 0.2s;
    }

    .station-card:hover {
        transform: translateY(-2px);
        border-color: #00d2ff88;
    }

    .card-top {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #1a1d2e;
        padding: 8px 12px;
        border-bottom: 1px solid #2e344e;
    }

    .freq-tag {
        color: #00d2ff;
        font-family: 'JetBrains Mono', monospace;
        font-weight: 800;
        font-size: 1.1em;
    }

    .pi-tag {
        font-size: 0.7em;
        color: #4b5563;
        font-family: monospace;
    }

    .card-main {
        padding: 15px;
        flex-grow: 1;
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .station-name {
        font-size: 1.4em;
        font-weight: 900;
        color: #fff;
        text-transform: uppercase;
        letter-spacing: 1px;
        line-height: 1.2;
    }

    .station-name.empty {
        color: #232738;
        font-size: 0.9em;
        font-style: italic;
    }

    .pty-tag {
        font-size: 0.65em;
        color: #94a3b8;
        background: #000;
        padding: 2px 8px;
        border-radius: 4px;
        align-self: flex-start;
        font-weight: bold;
        text-transform: uppercase;
    }

    .rt-container {
        background: #000;
        margin: 0 15px 15px;
        padding: 8px 12px;
        border-radius: 4px;
        border: 1px solid #002200;
        height: 60px;
        overflow-y: auto;
    }

    .rt-scroll-box {
        color: #00ff41;
        font-family: 'JetBrains Mono', monospace;
        font-size: 0.8em;
        line-height: 1.4;
        text-shadow: 0 0 5px rgba(0, 255, 65, 0.3);
    }

    .card-footer {
        background: #0a0c10;
        padding: 8px 12px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-top: 1px solid #1a1e26;
    }

    .flags {
        display: flex;
        gap: 4px;
    }

    .flag {
        width: 18px;
        height: 18px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 10px;
        font-weight: 800;
        background: #111;
        color: #222;
        border-radius: 2px;
    }

    .flag.active.tmc {
        background: #ff0055;
        color: #fff;
        box-shadow: 0 0 8px #ff005588;
    }

    .flag.active.ta {
        background: #ffaa00;
        color: #000;
        box-shadow: 0 0 8px #ffaa0088;
    }

    .flag.active.tp {
        background: #00d2ff;
        color: #000;
        box-shadow: 0 0 8px #00d2ff88;
    }

    .stats {
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        gap: 2px;
    }

    .pkts {
        color: #059669;
        font-size: 0.65em;
        font-family: monospace;
        font-weight: bold;
    }

    .time {
        color: #4b5563;
        font-size: 0.6em;
        font-family: monospace;
    }

    .no-data-notice {
        padding: 80px;
        text-align: center;
        color: #1a1e26;
    }

    .pulse {
        font-family: 'JetBrains Mono';
        font-weight: 900;
        font-size: 2em;
        letter-spacing: 10px;
        animation: glow 2s infinite;
    }

    .no-data-notice p {
        font-size: 0.8em;
        letter-spacing: 4px;
        text-transform: uppercase;
        margin-top: 10px;
    }

    @keyframes glow {
        0% {
            opacity: 0.3;
        }

        50% {
            opacity: 0.6;
        }

        100% {
            opacity: 0.3;
        }
    }
</style>