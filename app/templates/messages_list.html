{% for station in stations %}
<div class="data-row">
    <div class="row-meta">
        <span class="freq">{{ "%.1f"|format(station.frequency) }}</span>
        <span class="pi" title="PI Code">{{ station.pi if station.pi else '----' }}</span>
        <span class="hit-stats" title="Total Packets">{{ station.hit_count }}</span>
    </div>

    <div class="row-main">
        <div class="station-id">
            <span class="ps {{ 'dim' if not station.ps }}">{{ station.ps if station.ps else "SEARCHING..." }}</span>
            <span class="pty">{{ station.pty | pty_name }}</span>
        </div>

        <div class="rt-lane">
            <span class="rt-text">{{ station.rt if station.rt else '' }}</span>
        </div>
    </div>

    <div class="row-flags">
        <div class="flag-bit {{ 'active tmc' if station.tmc }}" title="TMC">M</div>
        <div class="flag-bit {{ 'active ta' if station.ta }}" title="TA">A</div>
        <div class="flag-bit {{ 'active tp' if station.tp }}" title="TP">P</div>
    </div>

    <div class="row-time">
        {{ station.last_seen.split(' ')[1].split('.')[0] if station.last_seen else '' }}
    </div>
</div>
{% endfor %}

{% if not stations %}
<div class="empty-feed">
    <span class="blink">SYSTEM STANDBY</span>
    <small>Awaiting signal correlation...</small>
</div>
{% endif %}

<style>
    .data-row {
        display: flex;
        align-items: center;
        background: #0d0f14;
        border-bottom: 1px solid #1a1e26;
        padding: 4px 10px;
        gap: 15px;
        font-family: 'JetBrains Mono', monospace;
        transition: background 0.1s;
    }

    .data-row:hover {
        background: #141820;
    }

    .row-meta {
        display: flex;
        align-items: center;
        gap: 8px;
        width: 130px;
        flex-shrink: 0;
    }

    .freq {
        color: #00d2ff;
        font-weight: 800;
        font-size: 0.95em;
        width: 45px;
    }

    .pi {
        color: #4b5563;
        font-size: 0.7em;
        width: 40px;
    }

    .hit-stats {
        color: #059669;
        font-size: 0.7em;
        text-align: right;
        flex-grow: 1;
    }

    .row-main {
        flex-grow: 1;
        display: flex;
        gap: 20px;
        overflow: hidden;
        align-items: center;
    }

    .station-id {
        display: flex;
        align-items: center;
        gap: 10px;
        width: 180px;
        flex-shrink: 0;
    }

    .ps {
        color: #fff;
        font-weight: bold;
        font-size: 0.9em;
        text-transform: uppercase;
    }

    .ps.dim {
        color: #2d333d;
        font-style: italic;
        font-size: 0.8em;
    }

    .pty {
        color: #64748b;
        font-size: 0.65em;
        font-weight: normal;
        border: 1px solid #2d333d;
        padding: 0 4px;
        border-radius: 2px;
    }

    .rt-lane {
        flex-grow: 1;
        overflow: hidden;
        white-space: nowrap;
        position: relative;
    }

    .rt-text {
        font-size: 0.85em;
        color: #10b981;
        opacity: 0.9;
    }

    .row-flags {
        display: flex;
        gap: 4px;
        width: 60px;
        flex-shrink: 0;
    }

    .flag-bit {
        width: 14px;
        height: 14px;
        background: #1a1e26;
        color: #2d333d;
        font-size: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 2px;
        font-weight: 900;
    }

    .flag-bit.active.tmc {
        background: #991b1b;
        color: #fecaca;
        box-shadow: 0 0 5px rgba(153, 27, 27, 0.5);
    }

    .flag-bit.active.ta {
        background: #92400e;
        color: #fef3c7;
        box-shadow: 0 0 5px rgba(146, 64, 14, 0.5);
    }

    .flag-bit.active.tp {
        background: #075985;
        color: #e0f2fe;
        box-shadow: 0 0 5px rgba(7, 89, 133, 0.5);
    }

    .row-time {
        width: 60px;
        text-align: right;
        font-size: 0.7em;
        color: #4b5563;
        flex-shrink: 0;
    }

    .empty-feed {
        padding: 60px;
        text-align: center;
        color: #1a1e26;
        display: flex;
        flex-direction: column;
        gap: 5px;
    }

    .empty-feed span {
        font-weight: 900;
        letter-spacing: 5px;
        font-size: 1.2em;
    }

    .blink {
        animation: pulse 2s infinite;
    }

    @keyframes pulse {
        0% {
            opacity: 0.2;
        }

        50% {
            opacity: 0.5;
        }

        100% {
            opacity: 0.2;
        }
    }
</style>